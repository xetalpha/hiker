{"last_chapter_rule":"","pageList":[{"col_type":"movie_3","name":"界面","path":"ui","rule":"js:\nfunction setDesc(arr, desc, num) {\n    desc = desc.constructor == Array ? desc.join('<br>') : desc;\n    if (desc.replace(/(<br>|\\s+)/g, '').length == 0) {\n        return\n    }\n    const mark = 'desc';\n    num = typeof(num) == 'undefined' ? 100 : num\n    desc = desc.startsWith('　　') ? desc : '　　' + desc;\n    desc = desc.replace(/'/g, \"&#39;\")\n    function substr(str, maxLength) {\n        let len = 0;\n        for (let i = 0; i < str.length; i++) {\n            if (str.charCodeAt(i) > 255) {\n                len += 2;\n            } else {\n                len++;\n            }\n            if (len > maxLength) {\n                return str.slice(0, i)+'...';\n            }\n        }\n        return str;\n    }\n    let sdesc = substr(desc, num);\n    var lazy = $(`#noLoading#`).lazyRule((dc, sdc, m) => {\n        var show = storage0.getItem(m, '0');\n        var title = findItem('desc').title;\n        var re = /(<\\/small><br>.*?>).+/g;\n        var exp = '展开:';\n        var ret = '收起:';\n        if (show == '1') {\n            updateItem('desc', {\n                title: title\n                    .replace(ret, exp)\n                    .replace(re, '$1' + sdc + '</small>')\n                    .replace(/(<\\/small><br><font color=\").*?(\">)/, '$1grey$2')\n\n            })\n            storage0.setItem(m, '0');\n        } else {\n            updateItem('desc', {\n                title: title\n                    .replace(exp, ret)\n                    .replace(re, '$1' + dc + '</small>')\n                    .replace(/(<\\/small><br><font color=\").*?(\">)/, '$1black$2')\n            })\n            storage0.setItem(m, '1');\n        }\n        return `hiker://empty`\n    }, desc, sdesc, mark)\n    var sc = storage0.getItem(mark, '0') == '0' ? '展开:' : '收起:';\n    var dc = storage0.getItem(mark, '0') == '0' ? sdesc : desc;\n    arr.push({\n        title: '' + '<font color=\"#098AC1\">∷剧情简介\t</font>' + \"<small><a style='text-decoration: none;' href='\" + lazy + \"'>\" + sc + '</a></small><br><font color=\"#696969\">' + `${dc}` + '</small>',\n        col_type: 'rich_text',\n        extra: {\n            id: 'desc',\n            lineSpacing: 6,\n            textSize: 15,\n            lineVisible: true,\n        }\n    })\n}\n\n\nfunction setDesc2(arr, desc) {\n    function cutstr(str, len) {\n        var str_length = 0;\n        var str_len = 0;\n        str_cut = new String();\n        str_len = str.length;\n        for (var i = 0; i < str_len; i++) {\n            a = str.charAt(i);\n            str_length++;\n            if (escape(a).length > 4) {\n                //中文字符的长度经编码之后大于4\n                str_length++;\n            }\n            str_cut = str_cut.concat(a);\n            if (str_length >= len) {\n                //达到目标长度，即为字符串加上省略号并返回\n                str_cut = str_cut.concat(\"...\");\n                return str_cut;\n            }\n        }\n        //如果字符串长度小于需要裁切的长度，直接返回\n        if (str_length < len) {\n            return str;\n        }\n    }\n    desc=desc.constructor==Array?desc.join('<br>'):desc;\n    if (desc.replace(/(<br>|\\s+)/g, '').length == 0) {\n        return\n    }\n    desc = '<small>' + desc + '</small>';\n    let sdesc = cutstr(desc, 100);\n    arr.push({\n        title: '剧情简介<span style=\"color:#ff0000;\"><b><small>' + storage0.getItem('dshow', '收起') + '</small></b></span>:',\n        col_type: 'avatar',\n        img: 'https://lanmeiguojiang.com/tubiao/system/75.png',\n        url: $('#noLoading#').lazyRule((dc, sdc) => {\n            var ds = storage0.getItem('dshow', '收起');\n            var title = findItem('dshow').title;\n            if (ds == '收起') {\n                storage0.setItem('dshow', '展开')\n                updateItem('dcontent', {\n                    title: dc,\n                });\n\n                updateItem('dshow', {\n                    title: title.replace('收起', '展开')\n                });\n\n                updateItem\n            } else {\n                storage0.setItem('dshow', '收起')\n                updateItem('dcontent', {\n                    title: sdc,\n                });\n\n                updateItem('dshow', {\n                    title: title.replace('展开', '收起')\n                });\n            }\n            return 'hiker://empty'\n        }, desc, sdesc),\n        extra: {\n            id: 'dshow',\n        }\n    })\n    arr.push({\n        title: storage0.getItem('dshow', '收起') == '收起' ? sdesc : desc,\n        col_type: 'rich_text',\n        extra: {\n            id: 'dcontent',\n            \"lineSpacing\": 5,\n            \"lineVisible\": false,\n            \"textSize\": 16,\n        }\n    })\n}"},{"col_type":"movie_3","name":"方法","path":"method","rule":"js:\nfunction urlParse(u) {\n    var dict = {}\n    dict.Source = u;\n    let params = (url) => {\n        let queryParams = {};\n        let reg = /([^?=&]+)=([^?=&]+)/g;\n        url.replace(reg, function() {\n            queryParams[arguments[1]] = arguments[2];\n        })\n        return queryParams\n    }\n    var javaUrl = JavaImporter(java.net.URL);\n    with(javaUrl) {\n        var url = new URL(u);\n        dict.Protocol = url.getProtocol();\n        dict.Host = url.getHost();\n        dict.Port = url.getPort();\n        dict.File = url.getFile();\n        dict.Path = url.getPath();\n        dict.Ref = url.getRef();\n        dict.Hosts = `${dict.Protocol}://${url.getHost()}`\n    }\n    dict.Params = params(u);\n    return dict;\n}\n\nObject.ToParams = function() {\n    var json = arguments[0];\n    return Object.keys(json).map(key => key + '=' + json[key]).join('&');\n}\n\nfunction isEqual(x, y) {\n    const ok = Object.keys,\n        tx = typeof x,\n        ty = typeof y;\n    return x && y && tx === 'object' && tx === ty ? (\n        ok(x).length === ok(y).length &&\n        ok(x).every(key => isEqual(x[key], y[key]))\n    ) : (x === y);\n}\n\nfunction findDifferentIndex(str1, str2) {\n    const diffChars = [];\n    for (let i = 0; i < str1.length; i++) {\n        if (str1[i] !== str2[i]) {\n            diffChars.push({\n                index: i,\n                s1: str1[i],\n                s2: str2[i]\n            });\n        }\n    }\n    return diffChars;\n}\n\n\nfunction replaceCharAt(str, index, replacement) {\n  if (index < 0 || index >= str.length) {\n    return str;\n  }\n  log(index)\n  const arr = str.split(\"\");\n  arr[index] = replacement;\n  return arr.join(\"\");\n}\n\n\n\n//构建下一页\n//参数1 源\n//参数2 目标\n//参数3 当前页\nfunction getNextUrl(source, target, params) {\n    var u1 = urlParse(source);\n    var u2 = urlParse(target);\n    var nexturl = source;\n    if (isEqual(u1.Params, u2.Params)) {\n        var ca = Object.keys(u2.Params).length == 0 ? '' : '?';\n        var df=findDifferentIndex(String(u1.Path),String(u2.Path));\n        var eq = replaceCharAt(String(u2.Path),df[0].index,'fypage');\n        log(u2.Path)\n        log(eq)\n        nexturl = u2.Hosts + eq + ca + Object.ToParams(u2.Params);\n    } else {\n        var eq = String(u1.Path).replace(/\\d+/, 'fypage');\n        nexturl = u1.Hosts + eq + Object.ToParams(u1.Params);\n    }\n    //log('next:'+nexturl)\n    return nexturl;\n}\n\nfunction createNextPage() {\n    let startnum = 1;\n    var arr = arguments[0];\n    //log(obj)\n    if (true_url != getMyVar('pageurl', '')) {\n        clearMyVar('pageurl');\n    }\n    if (page == startnum && getMyVar('pageurl') == '') {\n        //log('start')\n        var next = eval(下一页);\n        //log('next:' + next)\n        if (next != '') {\n            var nxurl = getNextUrl(true_url, next);\n            putMyVar(状态标记, nxurl);\n            putMyVar('pageurl', nxurl);\n        }\n    }\n}"}],"title":"下一页","author":"zetalpha","version":0,"type":"video","url":"hiker://empty##fypage","col_type":"movie_3","class_name":"","class_url":"","area_name":"","area_url":"","sort_name":"","year_name":"","sort_url":"8","year_url":"","find_rule":"js:\nvar d = [];\nvar page = MY_PAGE;\n\n\nvar url1 = 'http://www.huamaotv.com/type/2-1.html'\nvar url2 = 'http://www.huamaotv.com/type/2-2.html'\n\neval(JSON.parse(request('hiker://page/method', {})).rule)\nvar nxurl = getNextUrl(url1, url2);\nlog(nxurl)\n\n\n\n\n\n\n\n\nsetResult(d)","searchFind":"","search_url":"","group":"0⃣α测试","detail_col_type":"movie_1","detail_find_rule":"","sdetail_col_type":"movie_1","sdetail_find_rule":"","ua":"mobile","preRule":"","pages":"[{\"col_type\":\"movie_3\",\"name\":\"界面\",\"path\":\"ui\",\"rule\":\"js:\\nfunction setDesc(arr, desc, num) {\\n    desc = desc.constructor == Array ? desc.join('<br>') : desc;\\n    if (desc.replace(/(<br>|\\\\s+)/g, '').length == 0) {\\n        return\\n    }\\n    const mark = 'desc';\\n    num = typeof(num) == 'undefined' ? 100 : num\\n    desc = desc.startsWith('　　') ? desc : '　　' + desc;\\n    desc = desc.replace(/'/g, \\\"&#39;\\\")\\n    function substr(str, maxLength) {\\n        let len = 0;\\n        for (let i = 0; i < str.length; i++) {\\n            if (str.charCodeAt(i) > 255) {\\n                len += 2;\\n            } else {\\n                len++;\\n            }\\n            if (len > maxLength) {\\n                return str.slice(0, i)+'...';\\n            }\\n        }\\n        return str;\\n    }\\n    let sdesc = substr(desc, num);\\n    var lazy = $(`#noLoading#`).lazyRule((dc, sdc, m) => {\\n        var show = storage0.getItem(m, '0');\\n        var title = findItem('desc').title;\\n        var re = /(<\\\\/small><br>.*?>).+/g;\\n        var exp = '展开:';\\n        var ret = '收起:';\\n        if (show == '1') {\\n            updateItem('desc', {\\n                title: title\\n                    .replace(ret, exp)\\n                    .replace(re, '$1' + sdc + '</small>')\\n                    .replace(/(<\\\\/small><br><font color=\\\").*?(\\\">)/, '$1grey$2')\\n\\n            })\\n            storage0.setItem(m, '0');\\n        } else {\\n            updateItem('desc', {\\n                title: title\\n                    .replace(exp, ret)\\n                    .replace(re, '$1' + dc + '</small>')\\n                    .replace(/(<\\\\/small><br><font color=\\\").*?(\\\">)/, '$1black$2')\\n            })\\n            storage0.setItem(m, '1');\\n        }\\n        return `hiker://empty`\\n    }, desc, sdesc, mark)\\n    var sc = storage0.getItem(mark, '0') == '0' ? '展开:' : '收起:';\\n    var dc = storage0.getItem(mark, '0') == '0' ? sdesc : desc;\\n    arr.push({\\n        title: '' + '<font color=\\\"#098AC1\\\">∷剧情简介\\t</font>' + \\\"<small><a style='text-decoration: none;' href='\\\" + lazy + \\\"'>\\\" + sc + '</a></small><br><font color=\\\"#696969\\\">' + `${dc}` + '</small>',\\n        col_type: 'rich_text',\\n        extra: {\\n            id: 'desc',\\n            lineSpacing: 6,\\n            textSize: 15,\\n            lineVisible: true,\\n        }\\n    })\\n}\\n\\n\\nfunction setDesc2(arr, desc) {\\n    function cutstr(str, len) {\\n        var str_length = 0;\\n        var str_len = 0;\\n        str_cut = new String();\\n        str_len = str.length;\\n        for (var i = 0; i < str_len; i++) {\\n            a = str.charAt(i);\\n            str_length++;\\n            if (escape(a).length > 4) {\\n                //中文字符的长度经编码之后大于4\\n                str_length++;\\n            }\\n            str_cut = str_cut.concat(a);\\n            if (str_length >= len) {\\n                //达到目标长度，即为字符串加上省略号并返回\\n                str_cut = str_cut.concat(\\\"...\\\");\\n                return str_cut;\\n            }\\n        }\\n        //如果字符串长度小于需要裁切的长度，直接返回\\n        if (str_length < len) {\\n            return str;\\n        }\\n    }\\n    desc=desc.constructor==Array?desc.join('<br>'):desc;\\n    if (desc.replace(/(<br>|\\\\s+)/g, '').length == 0) {\\n        return\\n    }\\n    desc = '<small>' + desc + '</small>';\\n    let sdesc = cutstr(desc, 100);\\n    arr.push({\\n        title: '剧情简介<span style=\\\"color:#ff0000;\\\"><b><small>' + storage0.getItem('dshow', '收起') + '</small></b></span>:',\\n        col_type: 'avatar',\\n        img: 'https://lanmeiguojiang.com/tubiao/system/75.png',\\n        url: $('#noLoading#').lazyRule((dc, sdc) => {\\n            var ds = storage0.getItem('dshow', '收起');\\n            var title = findItem('dshow').title;\\n            if (ds == '收起') {\\n                storage0.setItem('dshow', '展开')\\n                updateItem('dcontent', {\\n                    title: dc,\\n                });\\n\\n                updateItem('dshow', {\\n                    title: title.replace('收起', '展开')\\n                });\\n\\n                updateItem\\n            } else {\\n                storage0.setItem('dshow', '收起')\\n                updateItem('dcontent', {\\n                    title: sdc,\\n                });\\n\\n                updateItem('dshow', {\\n                    title: title.replace('展开', '收起')\\n                });\\n            }\\n            return 'hiker://empty'\\n        }, desc, sdesc),\\n        extra: {\\n            id: 'dshow',\\n        }\\n    })\\n    arr.push({\\n        title: storage0.getItem('dshow', '收起') == '收起' ? sdesc : desc,\\n        col_type: 'rich_text',\\n        extra: {\\n            id: 'dcontent',\\n            \\\"lineSpacing\\\": 5,\\n            \\\"lineVisible\\\": false,\\n            \\\"textSize\\\": 16,\\n        }\\n    })\\n}\"},{\"col_type\":\"movie_3\",\"name\":\"方法\",\"path\":\"method\",\"rule\":\"js:\\nfunction urlParse(u) {\\n    var dict = {}\\n    dict.Source = u;\\n    let params = (url) => {\\n        let queryParams = {};\\n        let reg = /([^?=&]+)=([^?=&]+)/g;\\n        url.replace(reg, function() {\\n            queryParams[arguments[1]] = arguments[2];\\n        })\\n        return queryParams\\n    }\\n    var javaUrl = JavaImporter(java.net.URL);\\n    with(javaUrl) {\\n        var url = new URL(u);\\n        dict.Protocol = url.getProtocol();\\n        dict.Host = url.getHost();\\n        dict.Port = url.getPort();\\n        dict.File = url.getFile();\\n        dict.Path = url.getPath();\\n        dict.Ref = url.getRef();\\n        dict.Hosts = `${dict.Protocol}://${url.getHost()}`\\n    }\\n    dict.Params = params(u);\\n    return dict;\\n}\\n\\nObject.ToParams = function() {\\n    var json = arguments[0];\\n    return Object.keys(json).map(key => key + '=' + json[key]).join('&');\\n}\\n\\nfunction isEqual(x, y) {\\n    const ok = Object.keys,\\n        tx = typeof x,\\n        ty = typeof y;\\n    return x && y && tx === 'object' && tx === ty ? (\\n        ok(x).length === ok(y).length &&\\n        ok(x).every(key => isEqual(x[key], y[key]))\\n    ) : (x === y);\\n}\\n\\nfunction findDifferentIndex(str1, str2) {\\n    const diffChars = [];\\n    for (let i = 0; i < str1.length; i++) {\\n        if (str1[i] !== str2[i]) {\\n            diffChars.push({\\n                index: i,\\n                s1: str1[i],\\n                s2: str2[i]\\n            });\\n        }\\n    }\\n    return diffChars;\\n}\\n\\n\\nfunction replaceCharAt(str, index, replacement) {\\n  if (index < 0 || index >= str.length) {\\n    return str;\\n  }\\n  log(index)\\n  const arr = str.split(\\\"\\\");\\n  arr[index] = replacement;\\n  return arr.join(\\\"\\\");\\n}\\n\\n\\n\\n//构建下一页\\n//参数1 源\\n//参数2 目标\\n//参数3 当前页\\nfunction getNextUrl(source, target, params) {\\n    var u1 = urlParse(source);\\n    var u2 = urlParse(target);\\n    var nexturl = source;\\n    if (isEqual(u1.Params, u2.Params)) {\\n        var ca = Object.keys(u2.Params).length == 0 ? '' : '?';\\n        var df=findDifferentIndex(String(u1.Path),String(u2.Path));\\n        var eq = replaceCharAt(String(u2.Path),df[0].index,'fypage');\\n        log(u2.Path)\\n        log(eq)\\n        nexturl = u2.Hosts + eq + ca + Object.ToParams(u2.Params);\\n    } else {\\n        var eq = String(u1.Path).replace(/\\\\d+/, 'fypage');\\n        nexturl = u1.Hosts + eq + Object.ToParams(u1.Params);\\n    }\\n    //log('next:'+nexturl)\\n    return nexturl;\\n}\\n\\nfunction createNextPage() {\\n    let startnum = 1;\\n    var arr = arguments[0];\\n    //log(obj)\\n    if (true_url != getMyVar('pageurl', '')) {\\n        clearMyVar('pageurl');\\n    }\\n    if (page == startnum && getMyVar('pageurl') == '') {\\n        //log('start')\\n        var next = eval(下一页);\\n        //log('next:' + next)\\n        if (next != '') {\\n            var nxurl = getNextUrl(true_url, next);\\n            putMyVar(状态标记, nxurl);\\n            putMyVar('pageurl', nxurl);\\n        }\\n    }\\n}\"}]","proxy":"","icon":""}